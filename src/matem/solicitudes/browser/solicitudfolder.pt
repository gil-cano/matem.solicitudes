<html xmlns="http://www.w3.org/1999/xhtml"
      xml:lang="en"
      lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="plone">

  <head>
    <metal:block fill-slot="top_slot">
      <tal:insert tal:replace="nothing" tal:define="dummy python:request.set('enable_border', 0)" />
    </metal:block>
    <metal:css fill-slot="style_slot"
               tal:define="resources_url string:${context/portal_url}/++resource++wcfc">
      <link href="++resource++wcfc/bootstrap/bootstrap-fixed.css"
            tal:attributes="href string:${resources_url}/bootstrap/bootstrap-fixed.css"
            rel="stylesheet" type="text/css"/>
      <!-- Bootstrap Image Gallery styles -->
      <link rel="stylesheet"
            href="http://blueimp.github.com/Bootstrap-Image-Gallery/css/bootstrap-image-gallery.min.css"
            tal:attributes="href string:${resources_url}/jquery-file-upload/css/bootstrap-image-gallery.min.css" />
      <style type="text/css">
        #contentActionMenus{
            visibility: hidden;
        }
      </style>
    </metal:css>
  </head>

<!--   <metal:javascript_head fill-slot="javascript_head_slot">
    <tal:block define="macro here/archetypes_custom_js/macros/javascript_head | nothing"
               condition="macro">
      <metal:block use-macro="macro" />
    </tal:block>
    <tal:comment replace="nothing">
      Many of the following defines duplicated from the tal:defines in the
      main slot. With base_edit, edit_macros could be reused as it was defined
      for the entire document. base_view uses main_template and thus must
      create additional defines for each slot it fills.
    </tal:comment>
    <tal:js define="fields python:here.Schema().viewableFields(here);
                    js python:here.getUniqueWidgetAttr(fields, 'helper_js')"
            condition="js"
            repeat="item js">
      <script type="text/javascript"
              charset="iso-8859-1"
              tal:condition="python:exists('portal/%s' % item)"
              tal:attributes="src string:$portal_url/$item">
      </script>
    </tal:js>
    <tal:block define="portal_type python:here.getPortalTypeName().lower().replace(' ', '_');
                       view_template python:'%s_view' % portal_type;
                       view_macros python:path('here/%s/macros|nothing' % view_template);
                       macro view_macros/js | nothing"
               condition="macro">
      <metal:block use-macro="macro" />
    </tal:block>
  </metal:javascript_head>
 -->

 

  <body>
<!--       <metal:main_macro define-macro="main"
            tal:define="portal_type python:here.getPortalTypeName().lower().replace(' ', '_');
            base_macros here/base/macros;
            view_template python:'%s_view' % portal_type;
            view_macros python:path('here/%s/macros|nothing' % view_template);
            body_macro view_macros/body | body_macro | base_macros/body;
            folderlisting_macro view_macros/folderlisting | folderlisting | base_macros/folderlisting;
            errors python:request.get('errors', {})">
 -->
<!--     <metal:header_macro define-macro="header">
        <span tal:define="usuarioActual user/getId">
            <dl class="portalMessage warning"
                tal:condition="python:view.hasPendingReviews(usuarioActual)">
                <dt i18n:translate="label_atencion">
                    Attention!
                </dt>
                <dd i18n:translate="label_pending_reviews">
                     You have pending reviews! Review your pending requests using the square in the right called 'Review List'.
                </dd>
            </dl>
        </span>
        <p style="color: #FF0000;" tal:content="python:'Estado del Periodo '+str(here.Title())+': '+str(here.getWFStateName())"></p>
         <h1 class="documentFirstHeading">Menu, folder <span tal:replace="here/title_or_id">content title or id</span>
         </h1>
        </metal:header_macro>
 -->

    <metal:content-core fill-slot="content-core">
    <div class="fc">
      <div class="btn-group" tal:condition="python: str(here.getWFState()) != 'historico' ">
      <!-- <table class="listing" align="right" border="0"> -->
        <span class="btn text-right">
          <a href="" tal:attributes="href string:${context/absolute_url}/folder_factories">
            <img src="" width="20" height="20" tal:attributes="src string:${context/absolute_url}/++resource++nueva.png"/>
            Nueva Solicitud
          </a>
        </span>
      </div>


       <table align="center" border="0" tal:define="esNormal python:view.esSolicitanteNormal(user.getId())">
        <tr tal:condition="python:esNormal or ('Manager' in list(here.portal_membership.getAuthenticatedMember().getRoles()))">
        <form action="#" class="enableAutoFocus" method="post" name="ma"
              tal:attributes="action string:${context/absolute_url}/view">
        <td width="48" height="48"><a href="javascript: document.ma.submit()"><img src="#" width="48" height="48" tal:attributes="src string:${context/absolute_url}/++resource++ma.png"></a></td>
        <td>
            <input type="hidden" name="vistafolder" value="misaprobadas"/><br>
            <a href="javascript: document.ma.submit()"><label i18n:translate="label_approved_app">My approved applications</label></a>
            <div class="formHelp" i18n:translate="help_approved_app">Here you can see your approved applications</div><br>
        </td>
        </form>
        </tr>

        <tr tal:condition="python:esNormal or ('Manager' in list(here.portal_membership.getAuthenticatedMember().getRoles()))">
        <form action="#" class="enableAutoFocus" method="post" name="mr"
              tal:attributes="action string:${context/absolute_url}/view">
        <td width="48" height="48"><a href="javascript: document.mr.submit()"><img src="#" width="48" height="48" tal:attributes="src string:${context/absolute_url}/++resource++mr.png"></a></td>
        <td>
            <input type="hidden" name="vistafolder" value="misrechazadas"/><br>
            <a href="javascript: document.mr.submit()"><label i18n:translate="label_rejected_app">My rejected applications</label></a>
            <div class="formHelp" i18n:translate="help_rejected_app">Here you can see your rejected applications</div><br>
        </td>
        </form>
        </tr>

        <tr tal:condition="python:esNormal or ('Manager' in list(here.portal_membership.getAuthenticatedMember().getRoles()))">
        <form action="#" class="enableAutoFocus" method="post" name="me"
              tal:attributes="action string:${context/absolute_url}/view">
        <td width="48" height="48"><a href="javascript: document.me.submit()"><img src="#" width="48" height="48" tal:attributes="src string:${context/absolute_url}/++resource++me.png"></a></td>
        <td>
            <input type="hidden" name="vistafolder" value="misenviadas"/><br>
            <a href="javascript: document.me.submit()"><label i18n:translate="label_sent_app">In process applications</label></a>
            <div class="formHelp" i18n:translate="help_sent_app">Here you can see all the applications you have sent for review</div><br>
        </td>
        </form>
        </tr>

        <tr tal:condition="python:esNormal or view.esConsejero(user.getId()) or view.esComisionado(user.getId()) or ('Manager' in list(here.portal_membership.getAuthenticatedMember().getRoles()))">
        <form action="#" class="enableAutoFocus" method="post" name="p"
              tal:attributes="action string:${context/absolute_url}/view">
        <td width="48" height="48"><a href="javascript: document.p.submit()"><img src="#" width="48" height="48" tal:attributes="src string:${context/absolute_url}/++resource++p.png"></a></td>
        <td>
            <input type="hidden" name="vistafolder" value="folderpendientes"/><br>
            <a href="javascript: document.p.submit()"><label i18n:translate="label_pending_app">Pending for review</label></a>
            <div class="formHelp" i18n:translate="help_pending_app">Here you can see every application that needs your review</div><br>
        </td>
        </form>
        </tr>

        <tr tal:condition="python:view.esConsejero(user.getId()) or ('Manager' in list(here.portal_membership.getAuthenticatedMember().getRoles()))">
        <form action="#" class="enableAutoFocus" method="post" name="aa"
              tal:attributes="action string:${context/absolute_url}/view">
        <td width="48" height="48"><a href="javascript: document.aa.submit()"><img src="#" width="48" height="48" tal:attributes="src string:${context/absolute_url}/++resource++aa.png"></a></td>
        <td>
            <input type="hidden" name="vistafolder" value="folderaprobadas"/><br>
            <a href="javascript: document.aa.submit()"><label i18n:translate="label_allapproved_app">Public approved applications</label></a>
            <div class="formHelp" i18n:translate="help_allapproved_app">Here you can see every approved application in this period (even if it's not yours).</div><br>
        </td>
        </form>
        </tr>

        <tr tal:condition="python:view.esConsejero(user.getId()) or ('Manager' in list(here.portal_membership.getAuthenticatedMember().getRoles()))">
        <form action="#" class="enableAutoFocus" method="post" name="ar"
              tal:attributes="action string:${context/absolute_url}/view">
        <td width="48" height="48"><a href="javascript: document.ar.submit()"><img src="#" width="48" height="48" tal:attributes="src string:${context/absolute_url}/++resource++ar.png"></a></td>
        <td>
            <input type="hidden" name="vistafolder" value="folderrechazadas"/><br>
            <a href="javascript: document.ar.submit()"><label i18n:translate="label_allrejected_app">Public rejected applications</label></a>
            <div class="formHelp" i18n:translate="help_allrejected_app">Here you can see every rejected application in this period (even if it's not yours).</div><br>
        </td>
        </form>
        </tr>

        <tr tal:condition="view/programaPresupuesto">
        <form action="#" class="enableAutoFocus" method="post" name="pf"
              tal:attributes="action string:${context/absolute_url}/view">
        <td width="48" height="48"><a href="javascript: document.pf.submit()"><img src="#" width="48" height="48" tal:attributes="src string:${context/absolute_url}/++resource++presupuestolocal.png"></a></td>
        <td>
            <input type="hidden" name="vistafolder" value="presupuestolocal"/><br>
            <a href="javascript: document.pf.submit()"><label i18n:translate="label_localbudget_app">Total Local Budget</label></a>
            <div class="formHelp" i18n:translate="help_localbudget_app">Here you can see the detail of the local budgets for the current period.</div><br>
        </td>
        </form>
        </tr>

        <tr tal:condition="python: view.esSolicitanteAuxiliar() and str(here.getWFState()) != 'historico'">
        <td width="48" height="48"><a href="#" tal:attributes="href string:${context/absolute_url}/folder_factories"><img src="#" width="48" height="48" tal:attributes="src string:${context/absolute_url}/++resource++presupuestolocal.png"></a></td>
        <td>
            <a href="#" tal:attributes="href string:${context/absolute_url}/folder_factories"><label i18n:translate="label_applications_for_others">Subir solicitud a nombre de otra persona</label></a>
            <div class="formHelp" i18n:translate="help_applications_for_others">De click aqui si la solicitud que va a introducir al sistema no es para usted, sino para un tercero.</div><br>
        </td>
        </tr>
     </table>

      <ul class="btn-group">
        <li tal:repeat="transicion python:here.getLegalTransitions()">
          <a class="context btn btn-small" style="text-decoration:none" href="#" tal:attributes="href python:transicion['url']" tal:content="python:transicion['name']"/>
        </li>
        <li tal:condition="python:('Manager' in list(here.portal_membership.getAuthenticatedMember().getRoles()))">
          <a class="context btn btn-small" style="text-decoration:none" href="#" tal:attributes="href python:here.absolute_url()+'/delete_confirmation'">Eliminar folder de solicitudes.</a>
        </li>
      </ul>

    </div>
    </metal:content-core>

  </body>
</html>
